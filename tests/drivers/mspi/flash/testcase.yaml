# Copyright (c) 2024 Ambiq Micro Inc. <www.ambiq.com>
# Copyright (c) 2025 Siemens Mobility GmbH
# SPDX-License-Identifier: Apache-2.0

common:
  tags:
    - drivers
    - mspi
    - flash
  harness: ztest

tests:
  drivers.mspi.flash:
    filter: dt_compat_enabled("zephyr,mspi-emul-flash")
      or dt_compat_enabled("jedec,spi-nor") or dt_compat_enabled("jedec,mspi-nor")
      or dt_compat_enabled("mspi-atxp032") or dt_compat_enabled("mspi-is25xX0xx")
      or dt_compat_enabled("cdns,mspi-controller.yaml")
    harness: ztest
    platform_allow:
      - native_sim
      - apollo3p_evb
      - apollo510_evb
      - am243x_launchpad/am2434/r5f0_0
    integration_platforms:
      - native_sim
      - apollo3p_evb
      - apollo510_evb
      - am243x_launchpad/am2434/r5f0_0
  drivers.mspi.flash.xip_read:
    filter: dt_compat_enabled("mspi-is25xX0xx")
    platform_allow:
      - apollo510_evb
    integration_platforms:
      - apollo510_evb
    extra_configs:
      - CONFIG_FLASH_MSPI_XIP_READ=y
  drivers.mspi.flash.mspi_dw_system_workqueue:
    filter: dt_alias_exists("mspi0") and dt_compat_enabled("jedec,mspi-nor")
      and CONFIG_MSPI_DW
    integration_platforms:
      - nrf54h20dk/nrf54h20/cpuapp
    extra_configs:
      - CONFIG_MSPI_DW_HANDLE_FIFOS_IN_SYSTEM_WORKQUEUE=y
  drivers.mspi.flash.mspi_nor_no_multithreading:
    filter: dt_alias_exists("mspi0") and CONFIG_FLASH_MSPI_NOR
    platform_allow:
      - nrf54h20dk/nrf54h20/cpuapp
    extra_configs:
      - CONFIG_MULTITHREADING=n
